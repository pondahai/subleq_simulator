# Subleq 網頁模擬器

這是一個功能齊全、完全包含在單一 HTML 檔案中的 Subleq 指令集架構 (ISA) 模擬器。它不僅是一個執行環境，更是一個迷你的整合開發環境 (IDE)，讓您可以撰寫、組合、載入並逐步執行 Subleq 組合語言程式，是學習和實驗 OISC (One-Instruction Set Computer) 概念的絕佳工具。


![螢幕擷取畫面 2025-07-05 161211](https://github.com/user-attachments/assets/5813bd57-ad1f-4e97-a929-a25a9ec27cba)


## 專案亮點

*   **單一檔案，零依賴**：所有功能（HTML, CSS, JavaScript）都包含在一個檔案中，無需安裝任何伺服器或函式庫，直接用瀏覽器開啟即可使用。
*   **整合開發環境 (IDE)**：
    *   **源碼編輯區**：支援自訂的 Subleq 組合語言，語法清晰。
    *   **即時組合器 (Assembler)**：內建一個兩遍式組合器，支援**標籤 (Labels)**、**巨集 (Macros)**、**資料定義 (DATA)**、**註解**以及**運算式** (`.` 和 `+/-`)。
    *   **狀態與訊息**：清晰地顯示組合結果、錯誤訊息以及 CPU 執行狀態。
*   **清晰的開發流程**：獨立的 **「組合/載入」** 按鈕將程式準備階段與執行階段分離，允許您在執行前檢查機器碼，完美符合專業的開發習慣。
*   **強大的除錯功能**：
    *   **記憶體檢視器**：視覺化顯示記憶體內容，並高亮當前程式計數器 (PC) 位置以及最近被修改的記憶體單元。
    *   **執行控制**：提供「組合/載入」、「執行」、「暫停」、「單步」和「重設」等完整控制流程。
    *   **可調式速度**：自由調整程式的執行速度，方便觀察。
*   **互動式 I/O**：
    *   透過存取特殊位址 `-1` (預定義為 `IN` 和 `OUT`) 來模擬終端機的輸入和輸出。
    *   程式在執行（Run）或單步（Step）時需要輸入，都會自動暫停，並在輸入後智慧恢復原有的執行模式。

## 如何使用

1.  **下載檔案**：將 `subleq_simulator.html` 檔案下載到您的電腦上。
2.  **用瀏覽器開啟**：直接用任何現代網頁瀏覽器（如 Chrome, Firefox, Edge, Safari）開啟這個 HTML 檔案。
3.  **撰寫程式碼**：在左側的「程式源碼區」撰寫或貼上 Subleq 組合語言程式碼。
4.  **組合與載入**：點擊綠色的 **「組合/載入」** 按鈕。這是執行前的必要步驟。
    *   如果程式碼有誤，會在「組合/狀態訊息」區看到錯誤提示。
    *   如果成功，您可以在「記憶體區」看到翻譯後的機器碼，並可以**在執行前進行檢查**。
5.  **執行程式**：在成功載入後，「執行」和「單步」按鈕會被啟用。
    *   點擊 **「執行」** 按鈕以設定的速度連續執行程式。
    *   點擊 **「單步」** 按鈕一次只執行一條指令，方便除錯。
6.  **互動**：
    *   在「輸出區」查看程式的輸出。
    *   當程式需要輸入時，在「輸入區」輸入文字，程式會自動繼續執行。

## Subleq 組合語言語法簡介

*   **指令**: `A, B, C`
*   **標籤**: `MyLabel:`
*   **巨集**: `MACRO MyMacro(p1) ... ENDM` (注意：巨集必須在使用前定義)
*   **資料**: `MyData: 123` 或 `DATA 1, 2, 3`
*   **特殊符號**:
    *   `IN` / `OUT`: 代表 I/O 位址 `-1`。
    *   `.`: 代表「下一條指令」的位址 (即 `目前指令的起始位址 + 3`)。
*   **註解**: `#` 或 `;` 之後的內容會被忽略。

---

## 範例程式

這裡提供了兩個經過完整驗證的範例程式，您可以直接複製貼上到源碼區來體驗模擬器的功能。

### 範例 1：Hello, World!

這個程式使用「自我修改程式碼」技術來遍歷一個字串，並將其內容逐一輸出到終端機。

```assembly
# ========================================================
#   Subleq "Hello, World!" (最終正確版)
# ========================================================

# --- 巨集定義 (必須在使用前定義) ---
MACRO JUMP(TARGET)
    ZERO, ZERO, TARGET
ENDM

# --- 主程式 ---
LOOP:
    # 步驟 1: 載入字元到 TMP。執行後 TMP = -ASCII。
    # C 操作數是下一行(.)，確保程式繼續執行。
    LOAD_CMD: HELLO, TMP, .

    # 步驟 2: 檢查剛載入的字元是否為 0。
    # CHECKER = 0 - TMP = ASCII。
    CHECKER, CHECKER, .
    TMP, CHECKER, .
    
    # 步驟 2.1: 執行正確的檢查。
    # 如果 CHECKER 是 0，結果為 0，跳轉到 END。
    ZERO, CHECKER, END

    # 步驟 3: 輸出字元。
    # 從 TMP 重新恢復 CHECKER 的值來輸出。
    CHECKER, CHECKER, .
    TMP, CHECKER, .
    CHECKER, OUT, .

    # 步驟 4: 修改載入指令，使其指向下一個字元。
    NEG_ONE, LOAD_CMD, .
    
    # 步驟 5: 清理暫存器並跳回迴圈開頭。
    TMP, TMP, .
    JUMP(LOOP)

END:
    HALT, HALT, . - 2

# --- 資料與變數區 ---
TMP:        0       # 讀取字元時的暫存器 (會存負值)
CHECKER:    0       # 用於檢查和輸出的暫存器 (會存正值)
NEG_ONE:    -1      # 用於執行加法
ZERO:       0       # 用於無條件跳轉和檢查
HALT:       -1      # 用於停止程式

# --- 字串資料 ---
HELLO:
    DATA 72, 101, 108, 108, 111, 44, 32
    DATA 87, 111, 114, 108, 100, 33, 10
    DATA 0
```

### 範例 2：回音 (Echo)

這是一個簡單的互動程式。它會等待使用者輸入一個字元，然後將同樣的字元再輸出到螢幕上，並不斷重複此過程。

```assembly
# ========================================================
#   Subleq 範例: 回音程式 (Echo)
# ========================================================

# --- 巨集定義 ---
MACRO JUMP(TARGET)
    ZERO, ZERO, TARGET
ENDM

# --- 主程式 ---
START:
    # 步驟 1: 等待並讀取一個字元到 CHAR 變數中。
    IN, CHAR, .

    # 步驟 2: 輸出 CHAR 變數中的字元。
    CHAR, OUT, .
    
    # 步驟 3: 無條件跳轉回 START，繼續下一次循環。
    JUMP(START)

# --- 資料與變數區 ---
CHAR:       0       # 用來儲存輸入字元的變數
ZERO:       0       # 用於實現無條件跳轉
```
